<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RPG –ú–∏—Ä –¢–µ–Ω–µ–π</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      background: #111;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }
    #game {
      text-align: center;
      width: 320px;
      background: #222;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px #0af;
    }
    button {
      margin: 10px 5px;
      padding: 10px 25px;
      font-size: 18px;
      cursor: pointer;
      background: #0af;
      border: none;
      border-radius: 6px;
      color: white;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      background: #08c;
      transform: scale(1.05);
    }
    button:active {
      transform: scale(0.95);
    }
    #log {
      white-space: pre-line;
      margin-top: 15px;
      min-height: 80px;
      background: #111;
      padding: 10px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 16px;
      text-align: left;
      overflow-y: auto;
      max-height: 150px;
      box-shadow: inset 0 0 5px #0af;
    }
  </style>
</head>
<body>
  <div id="game">
    <div id="class-selection">
      <h2>–í—ã–±–µ—Ä–∏ –∫–ª–∞—Å—Å</h2>
      <button onclick="selectClass('–í–æ–∏–Ω')">–í–æ–∏–Ω</button>
      <button onclick="selectClass('–ú–∞–≥')">–ú–∞–≥</button>
      <button onclick="selectClass('–ú–æ–Ω–∞—Ö')">–ú–æ–Ω–∞—Ö</button>
    </div>

    <div id="actions" style="display:none;">
      <h2 id="class-title"></h2>

      <div>
        <p>üßë‚Äçüíª –í—ã: <span id="player-hp">100</span> HP</p>
        <p>üëπ –í—Ä–∞–≥: <span id="enemy-hp">100</span> HP</p>
      </div>

      <button onclick="attack()">–ê—Ç–∞–∫–∞</button>
      <button onclick="defend()">–ó–∞—â–∏—Ç–∞</button>
      <button onclick="showStatus()">–°—Ç–∞—Ç—É—Å</button>
      <p id="log"></p>
    </div>
  </div>

  <script>
    let playerClass = "";
    let playerHP = 100;
    let enemyHP = 100;
    let isDefending = false;

    function selectClass(chosenClass) {
      console.log("–í—ã–±—Ä–∞–Ω –∫–ª–∞—Å—Å:", chosenClass);
      playerClass = chosenClass;
      playerHP = 100;
      enemyHP = 100;
      isDefending = false;
      document.getElementById("class-selection").style.display = "none";
      document.getElementById("actions").style.display = "block";
      document.getElementById("class-title").textContent = `–ö–ª–∞—Å—Å: ${playerClass}`;
      updateHP();
      log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –∫–ª–∞—Å—Å: ${playerClass}`);
      saveProgress();
    }

    function attack() {
      const damage = getRandom(15, 25);
      enemyHP -= damage;
      log(`–í—ã –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥—É.`);
      checkBattleEnd();
      if (enemyHP > 0) enemyAttack();
      updateHP();
      saveProgress();
    }

    function defend() {
      isDefending = true;
      log("–í—ã –≤—Å—Ç–∞–ª–∏ –≤ –∑–∞—â–∏—Ç—É. –£—Ä–æ–Ω –ø–æ –≤–∞–º –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–µ–Ω.");
      enemyAttack();
      updateHP();
      saveProgress();
    }

    function enemyAttack() {
      let damage = getRandom(10, 20);
      if (isDefending) {
        damage = Math.floor(damage / 2);
        isDefending = false;
      }
      playerHP -= damage;
      logAppend(`–í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞ –≤–∞–º.`);
      checkBattleEnd();
    }

    function showStatus() {
      log(`–ö–ª–∞—Å—Å: ${playerClass}, –í–∞—à–µ –∑–¥–æ—Ä–æ–≤—å–µ: ${playerHP}, –ó–¥–æ—Ä–æ–≤—å–µ –≤—Ä–∞–≥–∞: ${enemyHP}`);
    }

    function updateHP() {
      document.getElementById("player-hp").textContent = Math.max(playerHP, 0);
      document.getElementById("enemy-hp").textContent = Math.max(enemyHP, 0);
    }

    function checkBattleEnd() {
      if (playerHP <= 0) {
        log("–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! ü™¶");
        disableButtons();
      } else if (enemyHP <= 0) {
        log("–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –≤—Ä–∞–≥–∞! üéâ");
        disableButtons();
      }
    }

    function disableButtons() {
      const buttons = document.querySelectorAll("#actions button");
      buttons.forEach(btn => btn.disabled = true);
    }

    function log(text) {
      document.getElementById("log").textContent = text;
    }

    function logAppend(text) {
      const current = document.getElementById("log").textContent;
      document.getElementById("log").textContent = current + "\n" + text;
    }

    function getRandom(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function saveProgress() {
      const data = {
        playerClass,
        playerHP,
        enemyHP,
        isDefending
      };
      localStorage.setItem("rpgSave", JSON.stringify(data));
    }

    function loadProgress() {
      const data = JSON.parse(localStorage.getItem("rpgSave"));
      if (data && data.playerClass) {
        playerClass = data.playerClass;
        playerHP = data.playerHP;
        enemyHP = data.enemyHP;
        isDefending = data.isDefending;
        document.getElementById("class-selection").style.display = "none";
        document.getElementById("actions").style.display = "block";
        document.getElementById("class-title").textContent = `–ö–ª–∞—Å—Å: ${playerClass}`;
        updateHP();
        log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ. –í—ã ‚Äî ${playerClass}`);
        checkBattleEnd();
      }
    }

    window.onload = loadProgress;
  </script>
</body>
</html>

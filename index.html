<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RPG –ú–∏—Ä –¢–µ–Ω–µ–π</title>
<style>
  body {
    margin: 0; padding: 0;
    font-family: sans-serif;
    background: #111;
    color: white;
    display: flex; justify-content: center; align-items: center;
    height: 100vh;
  }
  #game {
    text-align: center;
    max-width: 400px;
    width: 90vw;
  }
  button {
    margin: 10px;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    background: #222;
    border: none;
    color: white;
    border-radius: 5px;
    transition: background 0.3s;
  }
  button:hover:not(:disabled) {
    background: #444;
  }
  button:disabled {
    background: #555;
    cursor: not-allowed;
  }
  #log, #city-log {
    white-space: pre-line;
    min-height: 80px;
    background: #222;
    padding: 10px;
    border-radius: 5px;
    margin-top: 10px;
  }
</style>
</head>
<body>
  <div id="game">

    <div id="class-selection">
      <h2>–í—ã–±–µ—Ä–∏ –∫–ª–∞—Å—Å</h2>
      <button onclick="selectClass('–í–æ–∏–Ω')">–í–æ–∏–Ω</button>
      <button onclick="selectClass('–ú–∞–≥')">–ú–∞–≥</button>
      <button onclick="selectClass('–ú–æ–Ω–∞—Ö')">–ú–æ–Ω–∞—Ö</button>
    </div>

    <div id="actions" style="display:none;">
      <h2 id="class-title"></h2>
      <p>üßë‚Äçüíª –í—ã: <span id="player-hp">100</span> HP</p>
      <p>üëπ –í—Ä–∞–≥: <span id="enemy-hp">100</span> HP</p>
      <button onclick="attack()">–ê—Ç–∞–∫–∞</button>
      <button onclick="defend()">–ó–∞—â–∏—Ç–∞</button>
      <button onclick="showStatus()">–°—Ç–∞—Ç—É—Å</button>
      <p id="log"></p>
    </div>

    <div id="city" style="display:none;">
      <h2>üèô –ì–æ—Ä–æ–¥</h2>
      <p>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:</p>
      <button onclick="rest()">üõè –û—Ç–¥–æ—Ö–Ω—É—Ç—å</button>
      <button onclick="shop()">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
      <button onclick="startQuest()">‚öî –ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</button>
      <p id="city-log"></p>
    </div>

  </div>

<script>
  let playerClass = "";
  let playerHP = 100;
  let enemyHP = 100;
  let isDefending = false;
  let inBattle = false;

  function selectClass(chosenClass) {
    playerClass = chosenClass;
    playerHP = 100;
    enemyHP = 100;
    isDefending = false;
    inBattle = true;

    document.getElementById("class-selection").style.display = "none";
    document.getElementById("actions").style.display = "block";
    document.getElementById("city").style.display = "none";

    document.getElementById("class-title").textContent = `–ö–ª–∞—Å—Å: ${playerClass}`;
    updateHP();
    log(`–í—ã –≤—ã–±—Ä–∞–ª–∏ –∫–ª–∞—Å—Å: ${playerClass}. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –±–æ–π!`);
  }

  function attack() {
    if (!inBattle) return;
    const damage = getRandom(15, 25);
    enemyHP -= damage;
    log(`–í—ã –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞ –≤—Ä–∞–≥—É.`);
    checkBattleEnd();
    if (enemyHP > 0) {
      enemyAttack();
    }
    updateHP();
  }

  function defend() {
    if (!inBattle) return;
    isDefending = true;
    log("–í—ã –≤—Å—Ç–∞–ª–∏ –≤ –∑–∞—â–∏—Ç—É. –£—Ä–æ–Ω –ø–æ –≤–∞–º –±—É–¥–µ—Ç —É–º–µ–Ω—å—à–µ–Ω.");
    enemyAttack();
    updateHP();
  }

  function enemyAttack() {
    let damage = getRandom(10, 20);
    if (isDefending) {
      damage = Math.floor(damage / 2);
      isDefending = false;
    }
    playerHP -= damage;
    logAppend(`–í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç –∏ –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞ –≤–∞–º.`);
    checkBattleEnd();
  }

  function showStatus() {
    log(`–ö–ª–∞—Å—Å: ${playerClass}\n–í–∞—à–µ –∑–¥–æ—Ä–æ–≤—å–µ: ${playerHP}\n–ó–¥–æ—Ä–æ–≤—å–µ –≤—Ä–∞–≥–∞: ${enemyHP}`);
  }

  function updateHP() {
    document.getElementById("player-hp").textContent = Math.max(playerHP, 0);
    document.getElementById("enemy-hp").textContent = Math.max(enemyHP, 0);
  }

  function checkBattleEnd() {
    if (playerHP <= 0) {
      log("–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏! ü™¶");
      disableButtons();
      inBattle = false;
      setTimeout(() => {
        log("–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã.");
      }, 2000);
    } else if (enemyHP <= 0) {
      log("–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –≤—Ä–∞–≥–∞! üéâ –ü–µ—Ä–µ—Ö–æ–¥ –≤ –≥–æ—Ä–æ–¥...");
      disableButtons();
      inBattle = false;
      setTimeout(goToCity, 2000);
    }
  }

  function disableButtons() {
    const buttons = document.querySelectorAll("#actions button");
    buttons.forEach(btn => btn.disabled = true);
  }

  function enableButtons() {
    const buttons = document.querySelectorAll("#actions button");
    buttons.forEach(btn => btn.disabled = false);
  }

  function log(text) {
    document.getElementById("log").textContent = text;
  }

  function logAppend(text) {
    const current = document.getElementById("log").textContent;
    document.getElementById("log").textContent = current + "\n" + text;
  }

  function getRandom(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function goToCity() {
    document.getElementById("actions").style.display = "none";
    document.getElementById("city").style.display = "block";
    document.getElementById("city-log").textContent = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥–æ—Ä–æ–¥!";
  }

  function rest() {
    playerHP = 100;
    updateHP();
    document.getElementById("city-log").textContent = "–í—ã –æ—Ç–¥–æ—Ö–Ω—É–ª–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –∑–¥–æ—Ä–æ–≤—å–µ.";
    enableButtons();
  }

  function shop() {
    document.getElementById("city-log").textContent = "–ú–∞–≥–∞–∑–∏–Ω –ø–æ–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ —Å–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è!";
  }

  function startQuest() {
    enemyHP = 100;
    playerHP = Math.min(playerHP, 100);
    isDefending = false;
    inBattle = true;

    document.getElementById("city").style.display = "none";
    document.getElementById("actions").style.display = "block";
    enableButtons();

    document.getElementById("class-title").textContent = `–ö–ª–∞—Å—Å: ${playerClass}`;
    updateHP();
    log("–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ! –ë–æ–π –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è.");
  }
</script>

</body>
</html>